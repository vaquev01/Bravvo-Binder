import{r as l}from"./react-vendor-DpeMiI2M.js";import{c as ue,a as me}from"./index-CQ2kwkCc.js";function ge(V){var R;const{appData:a,setAppData:v}=ue(),{addToast:M}=me(),[se,H]=l.useState(!0),[re,O]=l.useState(null),m=l.useRef(null),ne={V1:"S1",V2:"S2",V3:"S3",V4:"S4",V5:"S5"}[V]||V,ae=((R=a==null?void 0:a.vaults)==null?void 0:R[ne])||{},oe=l.useCallback(()=>{var p,S,y,d,g,b,h,C,T,w,f,k,A,x,F,E,r,u,o,G,N,q,L,j,B,I,K,$,U,z,W,J,Q,X,Y,Z,_,ee,te;const t=(a==null?void 0:a.vaults)||{},s=((p=t.S1)==null?void 0:p.fields)||{},c=t.S2||{},n=t.S3||{},e=t.S4||{},i=t.S5||{};return{clientName:(a==null?void 0:a.clientName)||"",niche:s.niche||"gastronomia",tagline:s.tagline||"",promise:s.promise||"",enemy:s.enemy||"",brandValues:s.brandValues||s.values||[],audienceAge:s.audienceAge||"25-34",audienceGender:s.audienceGender||"todos",audienceClass:s.audienceClass||"bc",audiencePain:s.audiencePain||"",archetype:s.archetype||"O Cara Comum",tone:s.tone||"casual",bio:s.bio||"",products:c.products||[],currentTicket:((S=c.metrics)==null?void 0:S.currentTicket)||"",targetTicket:((y=c.metrics)==null?void 0:y.targetTicket)||"",currentRevenue:((d=c.metrics)==null?void 0:d.currentRevenue)||"",upsellStrategy:((g=c.strategy)==null?void 0:g.upsell)||"none",saleFormat:((b=c.strategy)==null?void 0:b.format)||"presencial",baitProduct:((h=c.bait)==null?void 0:h.product)||"",baitPrice:((C=c.bait)==null?void 0:C.price)||"",channels:n.channels||[],conversionLink:((w=(T=n.steps)==null?void 0:T.find(D=>D.step==="Desejo"))==null?void 0:w.goal)||"",instagramHandle:((f=n.social)==null?void 0:f.instagram)||"",websiteUrl:((k=n.social)==null?void 0:k.website)||"",primaryCTA:((A=n.cta)==null?void 0:A.primary)||"whatsapp",secondaryCTA:((x=n.cta)==null?void 0:x.secondary)||"saibamais",ctaText:((F=n.cta)==null?void 0:F.text)||"",monthlyGoal:((E=n.metrics)==null?void 0:E.monthlyGoal)||"",trafficType:((r=n.traffic)==null?void 0:r.primarySource)||"Misto",utmCampaign:((u=n.traffic)==null?void 0:u.utmCampaign)||"",currentConversion:((o=n.metrics)==null?void 0:o.currentConversion)||"",targetConversion:((G=n.metrics)==null?void 0:G.targetConversion)||"",cpl:((N=n.metrics)==null?void 0:N.cpl)||"",approverName:((L=(q=e.matrix)==null?void 0:q.find(D=>D.role==="Aprovador Final"))==null?void 0:L.who)||"",teamStructure:((B=(j=e.matrix)==null?void 0:j.find(D=>D.role==="Time"))==null?void 0:B.who)||"Enxuta",slaHours:parseInt((I=e.slas)==null?void 0:I.approval)||24,contentOwner:((K=e.owners)==null?void 0:K.content)||"",trafficOwner:(($=e.owners)==null?void 0:$.traffic)||"",supportOwner:((U=e.owners)==null?void 0:U.support)||"",emergencyContact:((z=e.contacts)==null?void 0:z.emergency)||"",postingFrequency:((W=e.schedule)==null?void 0:W.frequency)||"3x",bestDays:((J=e.schedule)==null?void 0:J.bestDays)||[],bestTimes:((Q=e.schedule)==null?void 0:Q.bestTimes)||[],startDate:((X=e.schedule)==null?void 0:X.startDate)||"",cycleDuration:((Y=e.schedule)==null?void 0:Y.cycleDuration)||"30",stakeholders:e.stakeholders||[],competitors:e.competitors||[],ideas:i.ideas||[],references:i.references||[],notepad:i.notepad||"",mood:((Z=i.rules)==null?void 0:Z.mood)||"moderno",primaryColor:((_=i.palette)==null?void 0:_.primary)||"#F97316",secondaryColor:((ee=i.palette)==null?void 0:ee.secondary)||"#1E293B",accentColor:((te=i.palette)==null?void 0:te.accent)||"#10B981",brandAssets:i.brandAssets||{logos:[],textures:[],icons:[],postTemplates:[]},brandIdentity:i.brandIdentity||{musicalStyle:"",visualVibes:[],keyElements:[],prohibitedElements:[],colorMeanings:"",photoStyle:"",typographyNotes:""},governanceHistory:(a==null?void 0:a.governanceHistory)||[],customThemeEnabled:(a==null?void 0:a.customThemeEnabled)||!1}},[a])(),P=l.useCallback((t,s)=>{H(!1),m.current&&clearTimeout(m.current),v(c=>{var i,p,S,y,d,g,b,h,C,T,w,f,k,A,x,F,E;const n={...c},e={...(c==null?void 0:c.vaults)||{}};if(t==="clientName")n.clientName=s;else if(t==="customThemeEnabled")n.customThemeEnabled=s;else if(["niche","tagline","promise","enemy","brandValues","audienceAge","audienceGender","audienceClass","audiencePain","archetype","tone","bio"].includes(t))e.S1={...e.S1||{},fields:{...((i=e.S1)==null?void 0:i.fields)||{},[t]:s,...t==="brandValues"?{values:s}:{}}};else if(t==="products")e.S2={...e.S2||{},products:s};else if(["currentTicket","targetTicket","currentRevenue"].includes(t))e.S2={...e.S2||{},metrics:{...((p=e.S2)==null?void 0:p.metrics)||{},[t]:s}};else if(["upsellStrategy","saleFormat"].includes(t)){const r=t==="upsellStrategy"?"upsell":"format";e.S2={...e.S2||{},strategy:{...((S=e.S2)==null?void 0:S.strategy)||{},[r]:s}}}else if(["baitProduct","baitPrice"].includes(t)){const r=t==="baitProduct"?"product":"price";e.S2={...e.S2||{},bait:{...((y=e.S2)==null?void 0:y.bait)||{},[r]:s}}}else if(t==="channels")e.S3={...e.S3||{},channels:s};else if(t==="conversionLink"){const r=((d=e.S3)==null?void 0:d.steps)||[],u=r.length?r.map(o=>(o==null?void 0:o.step)==="Desejo"?{...o,goal:s}:o):[{step:"Atenção",kpi:"CPM",goal:"R$ 10,00"},{step:"Interesse",kpi:"CTR",goal:"2%"},{step:"Desejo",kpi:"Click Whatsapp",goal:s}];e.S3={...e.S3||{},steps:u}}else if(["instagramHandle","websiteUrl"].includes(t)){const r=t==="instagramHandle"?"instagram":"website";e.S3={...e.S3||{},social:{...((g=e.S3)==null?void 0:g.social)||{},[r]:s}}}else if(["primaryCTA","secondaryCTA","ctaText"].includes(t)){const r=t==="primaryCTA"?"primary":t==="secondaryCTA"?"secondary":"text";e.S3={...e.S3||{},cta:{...((b=e.S3)==null?void 0:b.cta)||{},[r]:s}}}else if(["trafficType","utmCampaign"].includes(t)){const r=t==="trafficType"?"primarySource":"utmCampaign";e.S3={...e.S3||{},traffic:{...((h=e.S3)==null?void 0:h.traffic)||{},[r]:s}}}else if(["monthlyGoal","currentConversion","targetConversion","cpl"].includes(t))e.S3={...e.S3||{},metrics:{...((C=e.S3)==null?void 0:C.metrics)||{},[t]:s}};else if(t==="approverName"){const r=((T=e.S4)==null?void 0:T.matrix)||[],u=r.length?r.map(o=>o.role==="Aprovador Final"?{...o,who:s}:o):[{role:"Aprovador Final",who:s},{role:"Estrategista",who:"Bravvo Agent"},{role:"Time",who:"Enxuta"}];e.S4={...e.S4||{},matrix:u}}else if(t==="teamStructure"){const r=((w=e.S4)==null?void 0:w.matrix)||[],u=r.length?r.map(o=>o.role==="Time"?{...o,who:s}:o):[{role:"Aprovador Final",who:""},{role:"Estrategista",who:"Bravvo Agent"},{role:"Time",who:s}];e.S4={...e.S4||{},matrix:u}}else if(t==="slaHours")e.S4={...e.S4||{},slas:{...((f=e.S4)==null?void 0:f.slas)||{},approval:`${s}h`}};else if(["contentOwner","trafficOwner","supportOwner"].includes(t)){const r=t.replace("Owner","").toLowerCase();e.S4={...e.S4||{},owners:{...((k=e.S4)==null?void 0:k.owners)||{},[r]:s}}}else if(t==="emergencyContact")e.S4={...e.S4||{},contacts:{...((A=e.S4)==null?void 0:A.contacts)||{},emergency:s}};else if(["postingFrequency","bestDays","bestTimes","startDate","cycleDuration"].includes(t)){const r=t==="postingFrequency"?"frequency":t;e.S4={...e.S4||{},schedule:{...((x=e.S4)==null?void 0:x.schedule)||{},[r]:s}}}else if(["stakeholders","competitors"].includes(t))e.S4={...e.S4||{},[t]:s};else if(["ideas","references","notepad"].includes(t))e.S5={...e.S5||{},[t]:s};else if(t==="mood")e.S5={...e.S5||{},rules:{...((F=e.S5)==null?void 0:F.rules)||{},mood:s}};else if(["primaryColor","secondaryColor","accentColor"].includes(t)){const r=t.replace("Color","").toLowerCase();e.S5={...e.S5||{},palette:{...((E=e.S5)==null?void 0:E.palette)||{},[r]:s}}}else t==="brandAssets"?e.S5={...e.S5||{},brandAssets:s}:t==="brandIdentity"?e.S5={...e.S5||{},brandIdentity:s}:t==="governanceHistory"&&(n.governanceHistory=s);return n.vaults=e,n}),m.current=setTimeout(()=>{H(!0),O(Date.now())},500)},[v]),ce=l.useCallback(t=>{Object.entries(t).forEach(([s,c])=>{P(s,c)})},[P]),ie=l.useCallback(()=>{H(!0),O(Date.now())},[]),le=l.useCallback((t,s=V)=>{m.current&&clearTimeout(m.current),H(!0),O(Date.now()),M({title:`${s} Salvo`,description:"Dados sincronizados com sucesso.",type:"success",duration:2e3}),t&&t()},[M,V]);return l.useEffect(()=>()=>{m.current&&clearTimeout(m.current)},[]),{formData:oe,vaultData:ae,updateField:P,updateFields:ce,isSynced:se,lastSaveTime:re,markSynced:ie,saveAndAdvance:le}}export{ge as u};
